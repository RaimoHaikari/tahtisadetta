ylim(c(0, 23)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1, fill="blue) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1, color = '#163B8B', size = .8, alpha = 0.3) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1, color = '#163B8B', alpha = 0.3) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1, color = 'blue', alpha = 0.3) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1, color = 'blue', alpha = 0.9) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1, fill="#d2aa47", color = '#163B8B', alpha = 0.9) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
barColor = "#d2aa47"
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1, fill=barColor, color = '#163B8B', alpha = 0.9) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
barColor = hsl(12, 50%, 40%)
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1, fill=fillColor, color = fillColor, alpha = 0.9) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
fillColor = '#815BA4'
strokeColor = '#FEC418'
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
reviewsSummary %>%
top_n(10, wt = n) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, n), y= n)) +
geom_bar(stat = 'identity', fill = fillColor) +
coord_flip() +
labs(x="", y = "Arvostelujen määrä") +
geom_text(aes(label=n), hjust=-0.5, size=3) +
geom_text(aes(label=med), y=1, size=3, col="yellow")
reviewsSummary %>%
ggplot(aes(med)) %>%
stat_bin(binwidth = 1, fill=fillColor, color = strokeColor, alpha = 0.9)
reviewsSummary %>%
ggplot(aes(med)) +
stat_bin(binwidth = 1, fill=fillColor, color = strokeColor, alpha = 0.9)
reviewsSummary %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9)
reviewsSummary %>%
filter(n >= 3) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9)
reviewsSummary %>%
filter(n >= 3) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(range(reviewsSummary$n)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
reviewsSummary %>%
filter(n >= 3) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(range(reviewsSummary$n))
reviewsSummary %>%
filter(n >= 3) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(range(n))
yRange <- range(reviewsSummary$n)
reviewsSummary %>%
filter(n >= 3) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(yRange)
yRange <- range(reviewsSummary$n)
reviewsSummary %>%
filter(n >= 3) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,200))
yRange <- range(reviewsSummary$n)
reviewsSummary %>%
filter(n >= 3) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,25))
yRange <- range(reviewsSummary$n)
reviewsSummary %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9)
reviewsSummary %>% filter(n > 2)
reviewsSummary %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9)
reviewsSummary %>% filter(n > 2)
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9)
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9)
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(range(reviewsSummary$n))
yRange <- range(reviewsSummary$n)
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,50))
yRange <- range(reviewsSummary$n)
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,100))
summary(reviewsSummary$n)
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,100))
reviewsSummary %>%
group_by(n) %>%
mutate(num_dups = n())
reviewsSummary %>%
group_by(med) %>%
mutate(num_dups = n())
reviewsSummary %>%
group_by(med) %>%
mutate(Hits = n_distinct(med))
reviewsSummary %>%
group_by(med) %>%
summarise(n = n())
reviewsSummary %>% group_by(med) %>% summarise(n = n()) % select(n)
reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n)
max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,100))
max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.25, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,100))
max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,100))
yMax <- max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,yMax))
# Kaikkein useimmin esiintyvän mediaaniarvosanan esiintymiskertojen määrä
yMax <- max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,yMax)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1)
# Kaikkein useimmin esiintyvän mediaaniarvosanan esiintymiskertojen määrä
yMax <- max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,yMax)) +
stat_bin(binwidth=0.5, geom="text", aes(label=after_stat(count)), vjust=-1)
# Kaikkein useimmin esiintyvän mediaaniarvosanan esiintymiskertojen määrä
yMax <- max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,yMax)) +
stat_bin(binwidth=0.5, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Tähtiä keskimäärin", y="Elokuvien määrä")
# Kaikkein useimmin esiintyvän mediaaniarvosanan esiintymiskertojen määrä
yMax <- max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,yMax)) +
stat_bin(binwidth=0.5, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Tähtiä keskimäärin", y="Elokuvien määrä")
# Kaikkein useimmin esiintyvän mediaaniarvosanan esiintymiskertojen määrä
yMax <- max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 3) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,yMax)) +
stat_bin(binwidth=0.5, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Tähtiä keskimäärin", y="Elokuvien määrä")
# Kaikkein useimmin esiintyvän mediaaniarvosanan esiintymiskertojen määrä
yMax <- max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 10) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,yMax)) +
stat_bin(binwidth=0.5, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Tähtiä keskimäärin", y="Elokuvien määrä")
# Kaikkein useimmin esiintyvän mediaaniarvosanan esiintymiskertojen määrä
yMax <- max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 5) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,yMax)) +
stat_bin(binwidth=0.5, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Tähtiä keskimäärin", y="Elokuvien määrä")
# Kaikkein useimmin esiintyvän mediaaniarvosanan esiintymiskertojen määrä
yMax <- max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,yMax)) +
stat_bin(binwidth=0.5, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Tähtiä keskimäärin", y="Elokuvien määrä")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
fillColor = '#815BA4'
strokeColor = '#FEC418'
reviews <- read_csv(str_c("../DB/", "arvostelut.csv"), na="NA")
movies <- read_csv(str_c("../DB/", "elokuvat.csv"), na="NA")
distinctValues <- reviews %>%
distinct(criticID, name, .keep_all = TRUE) %>%
select(criticID, name)
distinctIds <- distinctValues %>%
group_by(criticID) %>%                  # Group it by "criticID"
summarise(Hits = n_distinct(name)) %>%  # Now summarise with unique elements per group
filter(Hits > 1)                        # Only dublicates are included
distinctNames <- distinctValues %>%
group_by(name) %>%
summarise(Hits = n_distinct(criticID)) %>%
filter(Hits > 1)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
fillColor = '#815BA4'
strokeColor = '#FEC418'
reviews <- read_csv(str_c("../DB/", "arvostelut.csv"), na="NA")
movies <- read_csv(str_c("../DB/", "elokuvat.csv"), na="NA")
distinctValues <- reviews %>%
distinct(criticID, name, .keep_all = TRUE) %>%
select(criticID, name)
distinctIds <- distinctValues %>%
group_by(criticID) %>%                  # Group it by "criticID"
summarise(Hits = n_distinct(name)) %>%  # Now summarise with unique elements per group
filter(Hits > 1)                        # Only dublicates are included
distinctNames <- distinctValues %>%
group_by(name) %>%
summarise(Hits = n_distinct(criticID)) %>%
filter(Hits > 1)
nrow(distinctIds)
nrow(distinctNames)
duplicateReviews <- reviews %>%
group_by(criticID, googleID) %>%
mutate(num_dups = n(), dup_id = row_number()) %>%
ungroup() %>%
filter(num_dups > 1)
nrow(duplicateReviews)/2
numOfRevs <- apply(movies[,c('id')], 1, function(x) {length(which(reviews$googleID == x))})
movies <- movies %>% mutate(nOfReviews = numOfRevs)
# movies <- movies %>% filter(numOfRevs > 0)
namedReviews <- reviews %>%
left_join(movies %>% filter(numOfRevs > 0), c("googleID" = "id")) %>%
select(-link, -wiki, -imdb, -kavi, -img, -nodeJS, -nOfReviews)
reviewsSummary <- namedReviews %>%
group_by(googleID) %>%
summarise(ka = mean(stars), med = median(stars), n = n())
movies %>%
ggplot(aes(x = nOfReviews)) +
stat_bin(binwidth = 1, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(range(movies$nOfReviews)) +
stat_bin(binwidth=1, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Kerättyjen arvostelujen määrä", y="Elokuvien määrä")
reviewsSummary %>%
top_n(10, wt = n) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, n), y= n)) +
geom_bar(stat = 'identity', fill = fillColor) +
coord_flip() +
labs(x="", y = "Arvostelujen määrä") +
geom_text(aes(label=n), hjust=-0.5, size=3) +
geom_text(aes(label=med), y=1, size=3, col="yellow")
# Kaikkein useimmin esiintyvän mediaaniarvosanan esiintymiskertojen määrä
yMax <- max(reviewsSummary %>% group_by(med) %>% summarise(n = n()) %>% select(n))
reviewsSummary %>%
filter(n > 2) %>%
ggplot(aes(med)) +
stat_bin(binwidth = 0.5, fill=fillColor, color = strokeColor, alpha = 0.9) +
ylim(c(0,yMax)) +
stat_bin(binwidth=0.5, geom="text", aes(label=after_stat(count)), vjust=-1) +
labs(x="Tähtiä keskimäärin", y="Elokuvien määrä")
reviewsSummary %>%
filter(n > 5)
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt=)
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= med)
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= med) %>%
left_join(movies, c("googleID" = "id"))
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= med) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, med), y=vote_average)) +
geom_bar(stat='identity', fill="blue")
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= med) %>%
left_join(movies, c("googleID" = "id"))
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= med) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, n), y=med)) +
geom_bar(stat='identity', fill="blue")
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= med) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue")
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= med) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip()
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip()
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo")
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo") +
geom_text(aes(label=ka), hjust=-0.1, size=3)
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo") +
geom_text(aes(label=ka), hjust=0.1, size=3)
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo") +
geom_text(aes(label=ka), hjust=1, size=3)
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo") +
geom_text(aes(label=format(round(ka, 2), nsmall = 2)), hjust=1, size=3)
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo") +
geom_text(aes(label=format(round(ka, 2), nsmall = 2)), hjust=1.2, size=3)
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo") +
geom_text(aes(label=format(round(ka, 2), nsmall = 2)), hjust=1.2, size=3, col="yellow")
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo") +
geom_text(aes(label=format(round(ka, 2), nsmall = 2)), hjust=1.2, size=3, col="yellow") +
scale_y_continuous(breaks=seq(0, 10, by=1))
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo") +
geom_text(aes(label=format(round(ka, 2), nsmall = 2)), hjust=1.2, size=3, col="yellow") +
scale_y_continuous(breaks=seq(0, 10, by=0.2))
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo") +
geom_text(aes(label=format(round(ka, 2), nsmall = 2)), hjust=1.2, size=3, col="yellow") +
scale_y_continuous(breaks=seq(0, 5, by=0.5))
reviewsSummary %>%
filter(n > 5) %>%
top_n(10, wt= ka) %>%
left_join(movies, c("googleID" = "id")) %>%
ggplot(aes(x=reorder(nimi, ka), y=ka)) +
geom_bar(stat='identity', fill="blue") +
coord_flip() +
labs(x="", y="Arvostelujen keskiarvo") +
geom_text(aes(label=format(round(ka, 2), nsmall = 2)), hjust=1.2, size=3, col="yellow") +
scale_y_continuous(breaks=seq(0, 5, by=0.5)) +
geom_text(aes(label=n), y=0.4, size=3, col="yellow")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyverse)
fillColor = '#815BA4'
strokeColor = '#FEC418'
reviews <- read_csv(str_c("../DB/", "arvostelut.csv"), na="NA")
movies <- read_csv(str_c("../DB/", "elokuvat.csv"), na="NA")
View(reviews)
